<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="/main.css" rel="stylesheet"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body class="grey-bg">
    <%- include('nav.ejs') %> <!-- ejsíŒŒì¼ ê°€ì ¸ì˜¬ë–„-->
    <p ><a href="/write">ê¸€ì‘ì„±</a></p>
    <input class="search">
    <button class="search-send">ê²€ìƒ‰</button> 
    <div class="white-bg">
      <%for(let i=0; i<posts.length; i++){%>
      <div class="list-box">
        <h4><a href="/detail/<%= posts[i]._id %>">
          <!--ì„œë²„ì‚¬ì´ë“œ ëœë”ë§ (ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜´)-->
          <%=posts[i].title%></h4></a>  
        <p><%=posts[i].content%></p>
        <a href="/edit/<%= posts[i]._id%>">âœï¸</a>
        <span class="delete" data-id = "<%= posts[i]._id%>">ğŸ—‘ï¸</span>
      </div>
    <% } %>  
      
    </div> 
    <a href="/list/next/<%= posts[posts.length - 1]._id %>">ë‹¤ìŒ</a>
  </body>
  <script>
    $(document).ready(() => {
        $(".delete").on('click',function(e){
          var parentElement = $(this).parent();
          $.ajax({
            url: '/delete?id='+ $(this).data('id'),
            type:'DELETE',
          })
          .done(function(response) {
            console.log('ë¬¸ì„œ ì‚­ì œ ì„±ê³µ:', response);
            parentElement.hide(); // ì‚­ì œëœ ìš”ì†Œë¥¼ í™”ë©´ì—ì„œ ìˆ¨ê¸°ê¸°
          })
          .fail(function(xhr, status, error) {
            console.error('ë¬¸ì„œ ì‚­ì œ ì‹¤íŒ¨:', error);
          });


        })
    })
    $(".search-send").on('click',function(){
      let input = $('.search').val();
      location.href= '/search?val=' + input
      
    })
  </script>
</html>